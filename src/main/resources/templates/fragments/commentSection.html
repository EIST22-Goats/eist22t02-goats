<section th:fragment="commentSection">
    <div class="d-flex" th:each="c: ${comments}">
        <div class="flex-shrink-0 pt-2">
            <img th:src="'/profile_pictures/'+${c.getAuthor().getTumId()}+'.png?'+${#dates.format(#dates.createNow(), 'ss')}"
                 alt="" class="rounded-circle"
                 width="32" height="32" style="object-fit: cover">
        </div>
        <div class="flex-grow-1 ms-3">
            <div class="mb-3">
                <form th:action="'/deleteComment/'+${c.getId()}" method="post">
                    <span th:text="${c.getAuthor().getFirstname()}+' '+${c.getAuthor().getLastname()}"
                          class="fw-bold"></span>
                    <br>
                    <span th:text="${c.getText()}"></span>
                    <br>
                    <a data-bs-toggle="collapse" th:href="'#newComment'+${c.getId()}" aria-expanded="false"
                       class="text-decoration-none">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                             class="bi bi-reply" viewBox="0 0 16 16">
                            <path d="M6.598 5.013a.144.144 0 0 1 .202.134V6.3a.5.5 0 0 0 .5.5c.667 0 2.013.005 3.3.822.984.624 1.99 1.76 2.595 3.876-1.02-.983-2.185-1.516-3.205-1.799a8.74 8.74 0 0 0-1.921-.306 7.404 7.404 0 0 0-.798.008h-.013l-.005.001h-.001L7.3 9.9l-.05-.498a.5.5 0 0 0-.45.498v1.153c0 .108-.11.176-.202.134L2.614 8.254a.503.503 0 0 0-.042-.028.147.147 0 0 1 0-.252.499.499 0 0 0 .042-.028l3.984-2.933zM7.8 10.386c.068 0 .143.003.223.006.434.02 1.034.086 1.7.271 1.326.368 2.896 1.202 3.94 3.08a.5.5 0 0 0 .933-.305c-.464-3.71-1.886-5.662-3.46-6.66-1.245-.79-2.527-.942-3.336-.971v-.66a1.144 1.144 0 0 0-1.767-.96l-3.994 2.94a1.147 1.147 0 0 0 0 1.946l3.994 2.94a1.144 1.144 0 0 0 1.767-.96v-.667z"/>
                        </svg>
                        Antworten
                    </a>
                    &nbsp;&nbsp;
                    <a data-bs-toggle="collapse" th:href="'#comments'+${c.getId()}" aria-expanded="false"
                       th:if="${!c.getChildComments().isEmpty()}"
                       th:text="${c.getChildComments().size()}+' Antworten ansehen'"
                       class="text-decoration-none"></a>
                    &nbsp;&nbsp;
                    <button type="submit" th:if="${c.getAuthor().getId() == person.getId()}"
                            class="text-decoration-none link-danger btn btn-link d-inline px-0">LÃ¶schen</button>
                    <input type="hidden" name="courseId" th:value="${course.getId()}">
                </form>
            </div>

            <form class="collapse" th:id="'newComment'+${c.getId()}" th:action="'/addComment/'+${c.getId()}"
                  method="post">
                <input type="hidden" name="courseId" th:value="${course.getId()}">
                <div class="mb-3 row">
                    <div class="col-10">
                        <textarea name="text" class="form-control" rows="1" placeholder="Neuer Kommentar"></textarea>
                    </div>
                    <div class="col-2">
                        <button type="submit" class="btn btn-primary">Senden</button>
                    </div>
                </div>
            </form>
            <div th:if="${!c.getChildComments().isEmpty()}" class="collapse" th:id="'comments'+${c.getId()}">
                <div th:with="comments=${c.getChildComments()}"
                     th:include="fragments/commentSection :: commentSection"></div>
            </div>
        </div>
    </div>
</section>